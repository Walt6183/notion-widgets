<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomodoro Timer</title>
    
    <!-- Notwendige Bibliotheken -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body { background-color: transparent; }
        ::-webkit-scrollbar { width: 0px; background: transparent; }
    </style>
</head>
<body class="h-screen flex items-center justify-center overflow-hidden bg-stone-50">

    <div id="root" class="w-full h-full flex items-center justify-center"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            const modes = {
                focus: { label: 'Fokus', minutes: 25, color: 'text-stone-800', bg: 'bg-stone-800', ring: '#292524' },
                short: { label: 'Pause', minutes: 5, color: 'text-teal-700', bg: 'bg-teal-600', ring: '#0d9488' },
                long: { label: 'Lang', minutes: 15, color: 'text-indigo-700', bg: 'bg-indigo-600', ring: '#4f46e5' }
            };

            const [currentMode, setCurrentMode] = useState('focus');
            const [timeLeft, setTimeLeft] = useState(modes.focus.minutes * 60);
            const [isActive, setIsActive] = useState(false);
            const timerRef = useRef(null);
            const totalTimeRef = useRef(modes.focus.minutes * 60);

            const playSound = () => {
                try {
                    const AudioContext = window.AudioContext || window.webkitAudioContext;
                    if (!AudioContext) return;
                    const ctx = new AudioContext();
                    const osc = ctx.createOscillator();
                    const gain = ctx.createGain();
                    osc.connect(gain);
                    gain.connect(ctx.destination);
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(523.25, ctx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(1046.5, ctx.currentTime + 0.1);
                    gain.gain.setValueAtTime(0.1, ctx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.00001, ctx.currentTime + 0.5);
                    osc.start();
                    osc.stop(ctx.currentTime + 0.5);
                } catch(e) {}
            };

            const switchMode = (m) => {
                setIsActive(false);
                setCurrentMode(m);
                setTimeLeft(modes[m].minutes * 60);
                totalTimeRef.current = modes[m].minutes * 60;
            };

            useEffect(() => {
                if (isActive && timeLeft > 0) {
                    timerRef.current = setInterval(() => setTimeLeft(t => t - 1), 1000);
                } else if (timeLeft === 0 && isActive) {
                    setIsActive(false);
                    playSound();
                    clearInterval(timerRef.current);
                }
                return () => clearInterval(timerRef.current);
            }, [isActive, timeLeft]);

            const formatTime = (s) => {
                const min = Math.floor(s / 60);
                const sec = s % 60;
                return `${min.toString().padStart(2,'0')}:${sec.toString().padStart(2,'0')}`;
            };

            const progress = (timeLeft / totalTimeRef.current) * (2 * Math.PI * 80);
            const dashOffset = (2 * Math.PI * 80) - progress;

            const PlayIcon = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>;
            const PauseIcon = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>;
            const ResetIcon = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>;

            return (
                <div className="flex flex-col items-center justify-center w-full max-w-sm p-4 rounded-xl shadow-sm border border-white/50 bg-gradient-to-br from-rose-100 via-white to-teal-100 ring-1 ring-black/5">
                    
                    <h1 className="mb-4 text-xl font-bold tracking-tight text-stone-700">Pomodoro Timer</h1>

                    <div className="flex space-x-1 mb-4 bg-white/60 p-1 rounded-lg w-full justify-between backdrop-blur-sm">
                        {Object.keys(modes).map(m => (
                            <button key={m} onClick={() => switchMode(m)} 
                                className={`flex-1 py-1 text-xs font-medium rounded-md transition-all ${currentMode === m ? 'bg-white text-stone-800 shadow-sm' : 'text-stone-500 hover:bg-white/40'}`}>
                                {modes[m].label}
                            </button>
                        ))}
                    </div>
                    
                    <div className="relative mb-6">
                        <svg className="w-48 h-48 transform -rotate-90">
                            <circle cx="96" cy="96" r="80" stroke="rgba(255,255,255,0.6)" strokeWidth="6" fill="transparent" />
                            <circle cx="96" cy="96" r="80" stroke={modes[currentMode].ring} strokeWidth="6" fill="transparent" 
                                strokeDasharray={2 * Math.PI * 80} strokeDashoffset={dashOffset} strokeLinecap="round" className="transition-all duration-1000 ease-linear"/>
                        </svg>
                        <div className="absolute inset-0 flex flex-col items-center justify-center">
                            <span className={`text-4xl font-light tabular-nums drop-shadow-sm ${modes[currentMode].color}`}>{formatTime(timeLeft)}</span>
                            <span className="text-stone-500 text-xs mt-1 uppercase tracking-widest">{isActive ? 'LÃ¤uft' : 'Pause'}</span>
                        </div>
                    </div>

                    <div className="flex items-center space-x-3">
                        <button onClick={() => setIsActive(!isActive)} className={`w-12 h-12 flex items-center justify-center rounded-full text-white shadow-md hover:shadow-lg hover:scale-105 transition-all ${modes[currentMode].bg}`}>
                            {isActive ? <PauseIcon/> : <PlayIcon/>}
                        </button>
                        <button onClick={() => {setIsActive(false); setTimeLeft(modes[currentMode].minutes * 60);}} className="w-8 h-8 flex items-center justify-center rounded-full bg-white text-stone-500 shadow-sm hover:bg-stone-50 hover:text-stone-700">
                            <ResetIcon/>
                        </button>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
